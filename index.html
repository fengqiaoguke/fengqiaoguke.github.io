<title>php8中文网</title>

<h1><a href="https://wiki.php.net/rfc/php8" target="_blank">PHP 8 发布首个 Alpha 版本</a></h1>
<strong>PHP 8，PHP 的一个新的大版本，预计将于 2020 年 12 月 3 日发布，这意味着将不会有 PHP 7.5 版本。PHP8 目前正处于非常活跃的开发阶段，所以在接下来的几个月里，情况可能会发生很大的变化。</strong>
<p>
	<p style="font-size:16px;color:#333333;text-align:justify;font-family:arial;background-color:#FFFFFF;">
		<span class="bjh-p">PHP 8 是一个新的主要版本，它引入了一些重大变更，以及许多新特性和性能改进，下边简单介绍一些亮点：</span>
	</p>
	<p style="font-size:16px;color:#333333;text-align:justify;font-family:arial;background-color:#FFFFFF;">
		<span class="bjh-p"><span class="bjh-strong" style="font-size:18px;font-weight:700;">JIT，Just-In-Time，即时编译</span></span>
	</p>
	<p style="font-size:16px;color:#333333;text-align:justify;font-family:arial;background-color:#FFFFFF;">
		<span class="bjh-p">最重大的特性非 JIT 莫属。该特性的研发历时多年，熬过了 PHP 5 与 7 大版本系列（PHP 6 项目流产），直到去年 3 月份才最终通过投票确认将进入 PHP 8。</span>
	</p>
	<p style="font-size:16px;color:#333333;text-align:justify;font-family:arial;background-color:#FFFFFF;">
		<span class="bjh-p">JIT 是一种编译器策略，它将代码表述为一种中间状态，在运行时将其转换为依赖于体系结构的机器码，并即时执行。在 PHP 中，这意味着 JIT 将为 Zend VM 生成的指令视为中间表述，并以依赖于体系结构的机器码执行，也就是说托管代码的不再是 Zend VM，而是更为底层的 CPU。</span>
	</p>
	<p style="font-size:16px;color:#333333;text-align:justify;font-family:arial;background-color:#FFFFFF;">
		<span class="bjh-p">虽然自 PHP 7.0 以来，通过优化核心数据结构 HashTable、强化 Zend VM 中某些操作码与持续改进 OPCache 的 Optimizer 组件等具体措施，PHP 性能得到了显著提升，但是实际上这些优化似乎已经走到极限了。现在 JIT 从底层着手，被认为是目前提升 PHP 性能的最佳出路。</span>
	</p>
	<p style="font-size:16px;color:#333333;text-align:justify;font-family:arial;background-color:#FFFFFF;">
		<span class="bjh-p">关于引入 JIT 后的性能对比（以及 PHP 8 整体性能），可以参考一下本月 Phoronix 的基准测试（注：用的是 5 月底的源码构建版进行的测试）。</span>
	</p>
	<p style="font-size:16px;color:#333333;text-align:justify;font-family:arial;background-color:#FFFFFF;">
		<span class="bjh-p"><span class="bjh-strong" style="font-size:18px;font-weight:700;">Union Types，联合类型</span></span>
	</p>
	<p style="font-size:16px;color:#333333;text-align:justify;font-family:arial;background-color:#FFFFFF;">
		<span class="bjh-p">Union Types 支持接收多个不同类型的值，它是两种或多种类型的集合，使用时可以选择其一。包括 PHP 在内的开源生态的标准库中使用联合类型非常普遍，PHP 支持联合类型，将会允许将更多类型信息从 phpdoc 迁移至函数签名。可以说，泛型之后，联合类型是目前类型声明系统中最大的突破口。</span>
	</p>
	<p style="font-size:16px;color:#333333;text-align:justify;font-family:arial;background-color:#FFFFFF;">
		<span class="bjh-p"><span class="bjh-strong" style="font-size:18px;font-weight:700;">Attributes，注解</span></span>
	</p>
	<p style="font-size:16px;color:#333333;text-align:justify;font-family:arial;background-color:#FFFFFF;">
		<span class="bjh-p">这里的 Attributes 也就是其它语言中的 annotations（注解），它提供了一种向类添加元数据的方法，无需解析文档块。</span>
	</p>
	<p style="font-size:16px;color:#333333;text-align:justify;font-family:arial;background-color:#FFFFFF;">
		<span class="bjh-p"><span class="bjh-strong" style="font-size:18px;font-weight:700;">新的 static 返回类型</span></span>
	</p>
	<p style="font-size:16px;color:#333333;text-align:justify;font-family:arial;background-color:#FFFFFF;">
		<span class="bjh-p">虽然已经可以返回 self，但是考虑到 PHP 具有动态类型的性质，PHP 8 中支持 static 返回类型将更加高效，对于许多开发者来说应当非常有用。</span>
	</p>
 
	<p style="font-size:16px;color:#333333;text-align:justify;font-family:arial;background-color:#FFFFFF;">
		<span class="bjh-p"><span class="bjh-strong" style="font-size:18px;font-weight:700;">WeakMap，弱映射</span></span>
	</p>
	<p style="font-size:16px;color:#333333;text-align:justify;font-family:arial;background-color:#FFFFFF;">
		<span class="bjh-p">WeakMaps 允许创建从对象到任意值的映射（类似 SplObjectStorage），而不会阻止对用作 key 的对象进行垃圾回收。只要将对象添加到 WeakMap 中，GC 在触发条件时就可以将其占用内存回收。</span>
	</p>
	<p style="font-size:16px;color:#333333;text-align:justify;font-family:arial;background-color:#FFFFFF;">
		<span class="bjh-p">PHP 7.4 中，实际上已经引入了对 WeakReference（弱引用）的支持。但是，原始的弱引用本身用途有限，而弱映射在实践中更为常用。由于没有提供注册销毁回调的功能，因此无法在 PHP 弱引用之上实现有效的弱映射。弱映射的一般用例是将数据与单个对象实例相关联，而不强迫它们保持活动状态，避免长时间运行的进程无谓地占用内存。</span>
	</p>
</p>
<p>
	<br />
</p>
<h1>PHP8新功能JIT 编译器、联合类型和属性</h1>
<p style="font-family:&quot;font-size:16px;background-color:#FFFFFF;">
	<p style="font-family:&quot;font-size:16px;background-color:#FFFFFF;">
		PHP 8.0 也有望在今年发布。程序员&nbsp;Brent Roose&nbsp;透露了即将在 2020 年 11 月底发布的 PHP 8.0 中即将发布的功能。此版本的第一个 Alpha 版将于 6 月 18 日发布。同时，PHP 8.0 将引入多项重大更改，并引入一些新功能，例如 JIT 编译器、联合类型和属性。
	</p>
	<p style="font-family:&quot;font-size:16px;background-color:#FFFFFF;">
		JIT 编译器
	</p>
	<p style="font-family:&quot;font-size:16px;background-color:#FFFFFF;">
		Roose&nbsp;解释称，尽管还没有基准测试，但&nbsp;JIT 编译器有可能改善 PHP 的性能。不像 C 或 Java 这样的编译语言，PHP 是一种解释性语言，这意味着它会在运行时转换为机器码。JIT 在运行时编译部分代码，以便可以使用代码的编译版本。并表示，将 JIT 编译器添加到 PHP 的原因是，它可能使其能够在 Web 开发上下文之外被视为一种高性能语言，并且可以随着时间的流逝而得到改进。但是，一个很大的缺点是维护起来很复杂。
	</p>
	<p style="font-family:&quot;font-size:16px;background-color:#FFFFFF;">
		联合类型
	</p>
	<p style="font-family:&quot;font-size:16px;background-color:#FFFFFF;">
		联合类型是两种或多种类型的集合，表示可以使用其中任何一种。而由于 PHP 是一种动态类型的语言，因此联合类型有很多用例。
	</p>
	<p style="font-family:&quot;font-size:16px;background-color:#FFFFFF;">
		属性
	</p>
	<p style="font-family:&quot;font-size:16px;background-color:#FFFFFF;">
		属性在其他语言中通常称为注解，它提供了一种向类添加元数据的方法，而无需解析文档块。&nbsp;
	</p>
</p>
